---
import type { CollectionEntry } from "astro:content";
import LayoutsTime from "@components/LayoutsTime.astro";
import Tag from "@components/ui/Tag.astro";

type Props = CollectionEntry<"articles">["data"];
const { title, pub_date, updated_date, tags, author, book_author } =
  Astro.props;
---

<header class="metadata">
  <h1>{title}</h1>

  <div class="meta-row">
    <div class="meta-group date-author">
      <LayoutsTime date={pub_date} />
      {
        updated_date && (
          <span class="updated">
            (Upd. <LayoutsTime date={updated_date} />)
          </span>
        )
      }
      <span class="sep">|</span>
      <span class="author">{book_author || author}</span>
    </div>

    <div class="meta-group tags-container">
      <span class="sep mobile-hidden">|</span>
      <ul class="tag-list">
        {
          tags.map((tag) => (
            <li>
              <Tag tag={tag} href={`/tags/${tag}`} />
            </li>
          ))
        }
      </ul>
    </div>
  </div>
</header>

<style>
  .metadata {
    margin-bottom: 2em;
  }

  h1 {
    font-family: var(--font-serif);
    font-size: 2.5em;
    line-height: 1.2;
    margin: 0.5em 0 0.5em;
    color: var(--neutral-100);
    text-wrap: balance;
  }

  .meta-row {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 0.5em 1em;
    font-family: var(--font-mono);
    font-size: 0.85em;
    color: var(--neutral-400);
  }

  .meta-group {
    display: flex;
    align-items: center;
    gap: 0.5em;
    white-space: nowrap;
  }

  .tag-list {
    display: flex;
    gap: 0.5em;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .sep {
    color: var(--neutral-600);
    font-weight: 300;
  }

  /* Mobile Constraints (<768px) */
  @media (max-width: 768px) {
    h1 {
      font-size: 1.8em;
    }

    .meta-row {
      flex-wrap: nowrap; /* Prevent wrapping */
      overflow-x: auto; /* Scroll if needed */
      scrollbar-width: none; /* Hide scrollbar */
      padding-bottom: 0.25em; /* Space for scroll */
      mask-image: linear-gradient(to right, black 90%, transparent 100%);
    }

    .updated {
      display: none; /* Hide update date on mobile */
    }

    .mobile-hidden {
      display: none;
    }

    /* Ensure tags don't shrink */
    .tag-list li {
      flex-shrink: 0;
    }
  }
</style>
