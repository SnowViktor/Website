---
import type { CollectionEntry, CollectionKey } from "astro:content";

import BaseLayout from "./BaseLayout.astro";

import ArticleNavigation from "../components/article_layout/ArticleNavigation.astro";

import { formatPubDate } from "../utils/format_pub-date";
interface Props {
    collectionName: string;
    entry: CollectionEntry<CollectionKey>;
    titlePubDate: boolean;
}
const { collectionName, entry, titlePubDate } = Astro.props;

const frontmatter = entry.data;

const formattedPubDate = formatPubDate(frontmatter.pubDate, false);
const formatTitle =
    titlePubDate && frontmatter.title
        ? `${formattedPubDate}．${frontmatter.title}`
        : frontmatter.title
          ? frontmatter.title
          : formattedPubDate;
---

<BaseLayout title={formatTitle} description={frontmatter.description}>
    <article>
        <p class={frontmatter.title ? "" : "no-h1"}>
            {collectionName}．<time datetime={frontmatter.pubDate.toISOString()}
                >{formatPubDate(frontmatter.pubDate, true)}</time
            >
        </p>
        {frontmatter.title && <h1>{frontmatter.title}</h1>}
        <hr />
        <div>
            <slot />
        </div>
    </article>
    <ArticleNavigation entry={entry} />
</BaseLayout>

<style>
    p {
        font-family: var(--font-serif);
        font-size: 0.8em;
        font-weight: 500;
        text-align: center;

        &.no-h1 {
            margin: calc(36px * 0.67) 0; /* 36px、0.67em 分別是 h1 的 font-size、margin-block。 */
        }
    }

    time {
        word-spacing: -0.15em;
    }

    div {
        font-family: var(--font-cursive);
        letter-spacing: 0;
    }
</style>
