/* 1. At-rules & Resets */
@import "./reset.css";

@media (prefers-reduced-motion: no-preference) {
  @view-transition {
    navigation: auto;
  }
}

/* 2. Custom Properties */
:root {
  --hue-neutral: 180;
  --chroma-neutral: 0.008;
  --neutral-100: oklch(0.99 var(--chroma-neutral) var(--hue-neutral));
  --neutral-200: oklch(0.95 var(--chroma-neutral) var(--hue-neutral));
  --neutral-300: oklch(0.85 var(--chroma-neutral) var(--hue-neutral));
  --neutral-400: oklch(0.7 var(--chroma-neutral) var(--hue-neutral));
  --neutral-500: oklch(0.55 var(--chroma-neutral) var(--hue-neutral));
  --neutral-600: oklch(0.45 var(--chroma-neutral) var(--hue-neutral));
  --neutral-700: oklch(0.35 var(--chroma-neutral) var(--hue-neutral));
  --neutral-800: oklch(0.27 var(--chroma-neutral) var(--hue-neutral));
  --neutral-900: oklch(0.22 var(--chroma-neutral) var(--hue-neutral));
  --neutral-950: oklch(0.17 var(--chroma-neutral) var(--hue-neutral));

  --color-everlasting-teal: #104e48;
  --hue-primary: 185;
  --chroma-primary: 0.06;
  --primary-100: oklch(0.95 var(--chroma-primary) var(--hue-primary));
  --primary-200: oklch(0.9 var(--chroma-primary) var(--hue-primary));
  --primary-300: oklch(0.85 var(--chroma-primary) var(--hue-primary));
  --primary-400: oklch(0.8 var(--chroma-primary) var(--hue-primary));
  --primary-500: oklch(0.75 var(--chroma-primary) var(--hue-primary));
  --primary-600: oklch(0.7 var(--chroma-primary) var(--hue-primary));
  --primary-700: oklch(0.65 var(--chroma-primary) var(--hue-primary));
  --primary-800: oklch(0.6 var(--chroma-primary) var(--hue-primary));
  --primary-900: oklch(0.55 var(--chroma-primary) var(--hue-primary));

  --opacity-10: 0.1;
  --opacity-20: 0.2;
  --opacity-30: 0.3;
  --opacity-40: 0.4;
  --opacity-50: 0.5;
  --opacity-60: 0.6;
  --opacity-70: 0.7;
  --opacity-80: 0.8;
  --opacity-90: 0.9;

  /* Typography */
  --font-sans: "Noto Sans", "Noto Sans TC", sans-serif;
  --font-serif: "Noto Serif", "Noto Serif TC", serif;
  --font-cursive: "Iansui", cursive;
  --font-mono: "Cascadia Code", monospace;

  /* Transitions & Animations */
  --transition-duration: 150ms;
  --transition-duration-long: 300ms;
  --transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);

  /* Borders */
  --border-radius-small: 0.6em;
  --border-radius-medium: 0.75em;
  --border-radius-large: 0.9em;

  /* Effects */
  --blur-small: 2px;
}

/* 3. Layout & Block Elements */
html {
  scrollbar-color: oklch(from var(--primary-900) l c h / var(--opacity-70))
    transparent;
}

body {
  margin: auto;
  max-width: 768px;
  background-color: var(--neutral-950);
  font-size: max(18px, 1rem);
  font-variant-numeric: ordinal;
  letter-spacing: 0.03em;
  text-autospace: normal; /* text-autospace: normal replace */
  text-spacing-trim: trim-start;
  word-break: auto-phrase;
  interpolate-size: allow-keywords;
  touch-action: manipulation;

  @media (max-width: 768px) {
    padding: 0.75em;
  }

  &::selection {
    background-color: var(--neutral-200);
    color: var(--neutral-950);
  }
}

main {
  display: flex;
  flex-direction: column;
  max-width: inherit;
  min-height: calc(100vh - (2.75em + 1em));
  margin: 2.75em auto 1em;
  color: var(--neutral-200);
  font-family: var(--font-sans);
  font-size: inherit;
  line-height: 2;
  text-align: justify;
}

blockquote {
  margin-inline: 0;
  padding-left: 0.75ch;
  border-left: 0.5ch solid var(--neutral-400);
}

hr {
  max-width: var(--max-width);
  border-color: var(--neutral-700);
  border-style: dashed;
}

/* 4. Typography */
:is(h1, h2, h3, h4, h5, h6) {
  font-weight: 900;
  line-height: 1.25;
}

h1 {
  margin-bottom: 0.25em;
  font-family: var(--font-serif);
  font-size: 2.5em;
  text-align: center;
}

h2 {
  margin-bottom: 0.5em;
  font-size: 2.25em;
}

h3 {
  margin-bottom: 0.75em;
  font-size: 2em;
}

h4 {
  margin-bottom: 1em;
  font-size: 1.75em;
}

h5 {
  margin-bottom: 1.25em;
  font-size: 1.5em;
}

h6 {
  margin-bottom: 1.5em;
  font-size: 1.25em;
}

li p:first-child {
  margin-bottom: 0;

  + p {
    margin-top: 0;
  }
}

a {
  color: inherit;
  text-decoration: none;
}

/* 5. Components */
.astro-code {
  anchor-name: --astro-code;
  padding: 0.5ch 0 0.5ch 1ch;
  border-radius: var(--border-radius-small);
  transition: border-top-right-radius var(--transition-duration)
    var(--transition-timing-function);
  font-size: 16px;
  font-variant-numeric: unset;
  line-height: 1.4;

  @supports (anchor-name: --astro-code) {
    &::before {
      content: attr(data-language);
      position: absolute;
      position-anchor: --astro-code;
      top: calc(anchor(top) - (1lh + 0.15em + 0.15em));
      right: anchor(right);
      padding-top: 0.15em;
      padding-inline: 1ch;
      border-bottom: 0.15em solid var(--neutral-600);
      border-radius: var(--border-radius-small) var(--border-radius-small) 0 0;
      background-color: inherit;
      opacity: 0;
      transition: inherit;
      transition-property: opacity;
      font-size: 14px;
      font-weight: 400;
      letter-spacing: 0;
    }

    &:focus-visible::before {
      border-bottom: unset;
      outline: inherit;
    }

    &:focus-visible,
    &:hover {
      border-top-right-radius: 0;

      &::before {
        opacity: 1;
      }
    }

    @media (max-width: 768px) {
      border-top-right-radius: 0;

      &::before {
        opacity: 1;
      }
    }
  }
}

/* 6. Interactive Elements */
:focus-visible {
  border-radius: inherit;
  outline: 2px solid var(--color-secondary);
}

details {
  margin-block: 1em;
  padding: 0.2em 0.7em;
  border: 0.1em outset var(--neutral-600);
  border-radius: var(--border-radius-medium);

  &::details-content {
    height: 0;
    padding-top: 0;
    transition: all var(--transition-duration-long)
      var(--transition-timing-function) allow-discrete;
    overflow-y: clip;
  }

  &[open]::details-content {
    height: auto;
    padding-top: 0.2em;
  }

  summary {
    cursor: pointer;
    user-select: none;
  }
}
